import { Component, OnInit, Input } from '@angular/core';
import * as _ from 'underscore';
import { ModeleEvenementService } from 'app/core/evenement/services/modele-evenement.service';
import { FieldEvenementCte } from 'app/core/evenement/constantes/field-evenement.constantes';
import { EvenementCte } from 'app/core/evenement/constantes/evenement.constantes';
import { Evenement } from 'app/shared/models/generic/Evenement';
import { ModeleValeur } from 'app/shared/utils/modele-valeur-builder';


@Component({
  selector: 'evenement-exploitation',
  providers: [ModeleEvenementService],
  templateUrl: './evenement-exploitation.component.html',
  styleUrls: ['./evenement-exploitation.component.scss']
})
export class EvenementExploitationComponent implements OnInit {

  @Input() evenement: Evenement;
  @Input() currentCtx: string; // mode d'accès à la ressource (lecture, edition)
  isCollapsedContent: boolean = true;
  field:{ [key: string]: any };
  classementsLocalisation: string[];
  categoriesAst: string[];
  consequencesAst: string[];
  modeleEvenementCte: { [key: string]: any };


  //----------------------------------------------------------------------------
  //-- INITIALISATION
  //----------------------------------------------------------------------------
  constructor(protected modeleEvenementService: ModeleEvenementService) { }

  ngOnInit() {
    this.field = FieldEvenementCte.FIELD;
    this.modeleEvenementCte = EvenementCte.INPUT;
    this.classementsLocalisation = _.values(ModeleEvenementService.enumerations[EvenementCte.INPUT.CLASSEMENTS_LOCALISATION].valeursEnumerations);
    this.categoriesAst = _.values(ModeleEvenementService.enumerations[EvenementCte.INPUT.CATEGORIES_AST].valeursEnumerations);
    this.consequencesAst = _.values(ModeleEvenementService.enumerations[EvenementCte.INPUT.CONSEQUENCES_AST].valeursEnumerations);
  }

  ficheRexExlploitationChange(value){
   if (this.evenement.attributs[this.field.ficheRexExlploitation].valeur === "0"){
    ModeleValeur.setValue(this.evenement.attributs[this.field.referenceRexExploitation], "");
   }
  }
}
